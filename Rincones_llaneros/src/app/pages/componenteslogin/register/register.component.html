<div class="register-container">
    <mat-card class="register-card">
        <!-- Logo -->
        <div class="logo-container">
            <img src="/logo.png" alt="Logo" class="logo">
        </div>

        <!-- Título y Subtítulo -->
        <mat-card-title class="register-title">REGÍSTRATE</mat-card-title>
        <p class="register-subtitle">
            ¿Eres un viajero? Descubre los mejores sitios turísticos de Casanare, encuentra promociones y planea tu aventura.
            <br>
            ¿Tienes un negocio turístico? Regístrate como vendedor, publica tus servicios y llega a más clientes.
            <br>
            ¡Únete y vive la experiencia llanera!
            <br>
            Regístrate ahora
        </p>

        <mat-card-content>
            <!-- Formulario -->
            <form [formGroup]="registerForm" (ngSubmit)="register()">
                <!-- Foto de Perfil -->
                <div class="profile-pic-container">
                    <label for="profile-pic-input" class="profile-pic-label">
                        <img *ngIf="previewUrl; else placeholder" [src]="previewUrl" alt="Foto de Perfil" class="profile-pic-preview">
                        <ng-template #placeholder>
                            <div class="profile-pic-placeholder">+</div>
                        </ng-template>
                    </label>
                    <input type="file" id="profile-pic-input" (change)="onFileSelected($event)" accept="image/*" hidden>
                    <div class="profile-actions">
                        <p class="profile-pic-text">
                            {{ previewUrl ? 'Eliminar imagen' : 'Haz clic para agregar una foto*' }}
                        </p>
                        <button 
                            *ngIf="previewUrl" 
                            mat-icon-button 
                            class="remove-pic-button" 
                            (click)="removeProfilePicture()" 
                            type="button" 
                            aria-label="Eliminar foto">
                            <mat-icon>close</mat-icon>
                        </button>
                    </div>
                </div>

                <!-- Campos del Formulario -->
                <div class="form-columns-container">
                    <div class="form-column">
                        <mat-form-field appearance="outline" class="role-selector">
                            <mat-label>Ejile el Rol</mat-label>
                            <mat-select formControlName="role" required>
                                <mat-option *ngFor="let rol of roles" [value]="rol.Id">
                                    {{ rol.Nombre }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Nombre y Apellido</mat-label>
                            <input matInput formControlName="fullName" required>
                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Correo</mat-label>
                            <input matInput formControlName="email" type="email" required>
                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Cédula</mat-label>
                            <input matInput formControlName="cedula" type="text" required maxlength="10" (keypress)="onlyNumberKey($event)">
                        </mat-form-field>
                    </div>
                    <div class="form-column">
                        <mat-form-field appearance="outline">
                            <mat-label>Número Telefónico</mat-label>
                            <input matInput formControlName="telefono" type="tel" required maxlength="10" (keypress)="onlyNumberKey($event)">
                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Contraseña</mat-label>
                            <input matInput [type]="showPassword ? 'text' : 'password'" formControlName="password" required maxlength="10">
                            <button mat-icon-button matSuffix (click)="showPassword = !showPassword" type="button">
                                <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                            </button>

                            <mat-error *ngIf="registerForm.get('password')?.touched && getPasswordError()">
                                {{ getPasswordError() }}
                            </mat-error>

                        </mat-form-field>
                        <mat-form-field appearance="outline">
                            <mat-label>Confirmar Contraseña</mat-label>
                            <input matInput [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword" required >
                            <button mat-icon-button matSuffix (click)="showConfirmPassword = !showConfirmPassword" type="button">
                                <mat-icon>{{ showConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                </div>

                <!-- Checkbox para aceptar políticas de privacidad -->
                <mat-checkbox formControlName="acceptTerms" class="terms-checkbox">
                    Acepto los <a (click)="goToPolitica()" class="terms-link">Términos y Condiciones</a> y las políticas de privacidad.
                </mat-checkbox>

                <!-- Mensajes Adicionales -->
                <p class="login-message">
                    ¿Ya tienes una cuenta?
                    <a (click)="goToLogin()" class="login-link">Inicia sesión</a>
                </p>

                <!-- Botón de Registro -->
                <button 
                    mat-raised-button 
                    type="submit" 
                    [disabled]="registerForm.invalid" 
                    class="submit-button">
                    Registrarme
                </button>

                <ng-template #successDialog>
                    <div class="modal-container">
                        <h2 mat-dialog-title>¡Registro exitoso!</h2>
                        <mat-dialog-content>
                            Tu cuenta ha sido creada correctamente. Serás redirigido al inicio de sesión.
                        </mat-dialog-content>
                    </div>
                </ng-template>
            </form>
        </mat-card-content>
    </mat-card>
</div>